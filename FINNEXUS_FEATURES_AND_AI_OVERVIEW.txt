UniGuard Wallet – Feature & AI Model Overview
=================================================

High-level purpose
------------------
UniGuard Wallet is a personal finance "command center" with:
- A 3D Nexus dashboard for visualizing money flows
- AI-assisted transaction capture, categorization, anomaly detection
- AI-guided budgeting via Flux Pods (smart budget containers)
- Goal forecasting and success probability estimation
- An AI companion chat that explains insights in plain language

The app is currently fully front‑end and uses **simulated/trained models implemented in TypeScript** (no external API calls), built on synthetic training data.


Core user-facing features by page
---------------------------------

1. Authentication (Auth.tsx)
   - Modern sign-in / sign-up UI with animated background, tabs for Login/Register.
   - Simulated authentication flows (no real backend):
     - Validates required fields, password strength, and terms acceptance.
     - On success, shows toast notifications and navigates to `/`.
   - Mentions security concepts (2FA, bank-level security) as UI copy; actual security flows are not wired yet.

2. Nexus Hub (index.tsx)
   - Acts as the main dashboard.
   - Includes:
     - **QuickStats**: Cards for today’s balance, health score, active goals, deadlines.
     - **FinancialNexus (3D)**: An interactive Three.js scene showing nodes like Income, Flux Pods, Goals, Net Worth, Expenses connected to a central core.
       - Purely visualization; it doesn’t yet directly read live data, but represents overall financial graph concepts.
     - **FluxPodPreview**: Compact view of key budget pods with animated progress bars and health states.
     - **RecentTransactions**: Last few transactions with icons, amounts and categories.

3. Transactions – “Transaction Center” (Transactions.tsx)
   - Rich transaction list with:
     - Grouping by day ("Today", "Yesterday", etc.).
     - Search box and filter panel (by category and type).
     - Multi-select with bulk delete.
     - Inline edit modal for updating description, amount, type, and category.
   - **Quick Entry with natural language parsing + AI categorization**:
     - Input examples: "spent 450 on coffee today", "received 45k freelance".
     - `parseNaturalLanguage` extracts:
       - Amount
       - Direction (income vs expense) via regex on verbs
       - Description text
     - Then uses `aiService.categorizeTransaction(...)` to predict the category from the text and amount.
     - Shows an "AI Parsing Preview" with predicted description, amount, type, category, and model confidence.
   - **Anomaly detection badges**:
     - On mount/update, builds `TrainingTransaction` set from current transactions.
     - For each transaction, runs `detectAnomaly` to check if its amount/category is unusual given history.
     - Displays an "AI Alert" badge with severity-based styles and tooltip reason.
   - **Inline AI recategorization**:
     - In the edit dialog, "AI Recategorize" uses `aiService.categorizeTransaction` again on the edited text/amount to suggest a better category.

4. Flux Pods – “Living budget containers” (FluxPods.tsx)
   - Concept: Each pod is a dynamic budget envelope with its own allocated amount, spending, health state, and velocity.
   - UI features:
     - Grid of animated pod cards showing:
       - Allocated vs spent, remaining budget.
       - Velocity (days until depletion at current rate).
       - Health status labels: healthy, warning, critical.
     - Expandable child pods for sub‑categories (e.g., Essentials → Groceries, Utilities, Housing).
     - Pod actions: "Reallocate" and "Configure" (visual/actions stubs for future logic).
   - **AI spending forecasts per pod**:
     - Builds synthetic training data by combining base training data with derived transactions from pods (`buildPodTransactions`).
     - Calls `aiService.forecastSpending` for each pod to get:
       - Predicted monthly spend
       - Days until budget depletion
       - Trend label (e.g., stable / rising / falling)
     - Uses those results to compute `daysLeft` and display health dynamics.
   - **AI suggestion for new pods**:
     - In `NewPodDialog`, when user types a name, calls `aiService.suggestNewPodAllocation`:
       - Suggests an allocation amount for the new pod.
       - Provides human-readable reasoning.
       - User can apply the suggestion with one click.

5. Goals & Orbits (Goals.tsx)
   - Goals have: name, target amount, current amount, monthly contribution, deadline, status.
   - UI concept:
     - Each goal is shown as an "orbit" card:
       - Ring chart around percentage complete.
       - Time to deadline and remaining amount.
       - Goal metadata like monthly contributions and linked pods.
   - **AI goal predictions**:
     - Uses `generateTrainingData()` to build synthetic history.
     - `aiService.initialize` is called with this data and a configured monthly income.
     - For each goal, calls `aiService.predictGoal` → `goal-predictor` to compute:
       - `completionProbability` (0–1)
       - `monthsToComplete`
       - `successLikelihood` (very-high / high / medium / low)
     - These predictions are shown alongside the orbit card (probability, expected months, etc.).

6. AI Companion (Companion.tsx)
   - Chat-like experience with quick actions (Spending Analysis, Goal Progress, Budget Tips, Financial Health).
   - Handles text input and optional browser speech recognition for voice capture.
   - On send:
     - Appends user message.
     - Simulates latency then calls `buildAiResponse` to generate an assistant message.
   - **AI logic (companion.ts)**:
     - Lazily initializes `aiService` with synthetic training data.
     - Builds responses based on recognized intent in the input string:
       - Spending / expense → spending summary using `aiService.getDashboardInsights`.
       - Goal / target     → guidance on goal setup and how prediction will work.
       - Budget / tips      → budget optimization tips informed by insights.
       - Health / score      → approximate financial health score computed from savings rate.
     - Returns both a `content` string (multi‑line) and follow-up `suggestions` that drive UX chips.

7. Reports (Reports.tsx)
   - Multi-tab analytics area (Overview, Income, Expenses, Categories, Weekly).
   - Uses Recharts charts (line, bar, pie) on pre-defined sample data.
   - Summary insight cards (spending trend, savings rate, top category).
   - Export feature:
     - Generates a CSV from monthly/weekly/category data and triggers a client-side download.
   - Currently deterministic (no AI model integration yet), but conceptually complements AI insights shown elsewhere.

8. Achievements (Achievements.tsx)
   - Gamification layer on top of financial activity.
   - Predefined achievements with categories and rarity levels:
     - Examples: First Steps, Goal Getter, Savings Master, Budget Warrior, Flux Pod Master, Millionaire, Nexus Explorer.
   - Shows unlocked vs locked achievements, completion rate, points, and progress bars for in-progress goals.
   - Uses motion/visual cues to make progress feel rewarding; does not currently read from live metrics but is designed as a narrative layer over user behavior.

9. Settings (Settings.tsx)
   - Tabs for Profile, Notifications, Preferences, Security, Data.
   - Examples of functionality:
     - Update profile info (name, email, phone).
     - Toggle notification types (budget alerts, goal reminders, weekly reports).
     - UI preferences: theme, language, date format, currency.
     - Security stubs: password change, 2FA toggle (with toasts indicating future availability).
     - Data export (JSON) and delete-account stub.
   - Helps position the app as a more complete product, even though back-end integration is not yet present.

10. Layout & Shell
    - `AppLayout` wraps pages in a global layout with sidebar and optional AI panel.
    - `Sidebar` component provides navigation to Nexus Hub, Transactions, Flux Pods, Goals, AI Companion, Reports, Achievements, Settings.
    - Extensive Shadcn/Radix UI component set for consistent, modern UX.


AI models and service layer
---------------------------

All AI behavior is routed through `src/lib/ai/ai-service.ts` and underlying model modules. These are **hand-crafted, rule/statistics-based simulations** of what real ML models would do.

1. AIService (ai-service.ts)
   - Central orchestrator / facade exposed as `aiService` singleton.
   - Maintains:
     - `historicalTransactions: TrainingTransaction[]`
     - `monthlyIncome: number`
   - Methods:
     - `initialize(transactions, income)`
     - `categorizeTransaction(...)`
     - `forecastSpending(category, allocated, spent, daysInPeriod)`
     - `suggestBudgetAllocation(availableBudget, currentAllocations, activeGoals)`
     - `suggestNewPodAllocation(podName, availableBudget, existingPods)`
     - `predictGoal(goal, activeGoals)`
     - `detectAnomaly(transaction)`
     - `getDashboardInsights()` (savings rate, totals, top categories)

2. Transaction Categorization Model (models/transaction-categorizer.ts)
   - Simulates a trained NLP/BERT-style classifier.
   - Core ideas:
     - Uses `extractTransactionFeatures` (keyword flags, amount features, etc.).
     - Has `categoryWeights` and references `trainedCategoryKeywords`, `trainedCategoryPriors`, `trainedCategoryWeights` (artifacts) to score each category.
     - Produces:
       - `category` (best match)
       - `confidence` (0–1)
       - `alternatives` (top alternative categories with confidences)
   - Usage:
     - Quick Entry parsing and AI preview.
     - Edit dialog "AI Recategorize".

3. Spending Forecaster (models/spending-forecaster.ts)
   - Simulates a time-series (LSTM-like) model for predicting future spending by category.
   - Logic:
     - For categories with no history:
       - Falls back to `trainedAverages` & `trainedSeasonality` (learned artifacts), uses heuristics to estimate monthly spend and days until depletion.
     - For categories with history:
       - Winsorizes amounts to reduce outlier impact.
       - Computes daily velocity, transaction counts, and data quality.
       - Estimates predicted monthly spend, confidence interval, trend direction, seasonal factor, and risk level.
   - Feeds Flux Pods page with `daysUntilDepletion`, `trend`, risk flags.

4. Budget Allocation Model (models/budget-allocator.ts)
   - Simulates an optimization model that allocates income across categories and goals.
   - Inputs:
     - Available budget
     - Historical expense transactions
     - Current category allocations
     - Monthly income
     - Active goals and their contributions
   - Behaviors:
     - Computes historical per-category spending and averages.
     - Uses `trainedBudgetShares` if no history exists.
     - Adjusts for data sparsity with smoothing and confidence scores.
     - Scales allocations so the sum doesn’t exceed budget.
     - Returns per-category `BudgetAllocation`:
       - `suggestedAmount`, `confidence`, `reasoning`, `minAmount`, `maxAmount`.
     - Aggregates into `AllocationRecommendation` with `totalSuggested`, `expectedSavings`, `riskAssessment`.
   - Used by:
     - Flux Pods overview (conceptually; current UI focuses more on forecasts and new pod suggestions).
     - New pod allocation via `suggestNewPodAllocation`.

5. Goal Predictor (models/goal-predictor.ts)
   - Simulates a probabilistic model with Monte Carlo-style reasoning.
   - Steps:
     - Compute remaining amount and months until deadline.
     - Derive required vs current monthly contributions.
     - Use a seeded RNG (`mulberry32`) based on goal attributes to generate repeatable pseudo Monte Carlo simulations of contribution/spending variability.
     - Estimate:
       - Completion probability
       - Predicted completion date
       - Months to complete
       - Confidence interval
       - Risk factors and `successLikelihood`.
   - Used on Goals page to show AI prediction chips.

6. Anomaly Detector (models/anomaly-detector.ts)
   - Simulates an Isolation Forest / statistical anomaly detection model.
   - Logic:
     - Guard rails when there is insufficient data.
     - Uses category-specific historical distributions (mean, stddev, median, MAD) and `trainedCategoryStats` artifacts.
     - Computes robust Z-scores; flags anomalies at different thresholds:
       - High: > 3σ, unusual magnitude, possible fraud or major one-time events.
       - Medium/Low: moderate deviations, duplicates, or new merchants.
     - Outputs `AnomalyResult` with:
       - `isAnomaly`, `anomalyScore`, `reason`, `severity`, `suggestedAction`, `dataQuality`.
   - Integrated into Transactions UI as AI Alert badges.

7. AI Companion logic (companion.ts)
   - Lightweight conversation policy on top of `aiService`.
   - Patterns input text for key topics (spending, budget, goals, health) and maps them to:
     - Summaries from `getDashboardInsights`.
     - Pre-baked guidance about goals and predictions.
     - Budgeting tips referencing top spending categories.
   - Returns both text and next-step suggestion chips.

8. Training data & features (training-data.ts)
   - Generates synthetic `TrainingTransaction` list across many categories (Coffee, Dining, Shopping, Tech, Transport, Health, Rent, Utilities, Food, Travel, Income, etc.).
   - Expands data with slight variations and date offsets to emulate a richer dataset.
   - Provides `extractTransactionFeatures` used by categorizer.
   - Provides `prepareSpendingPatternData` helper for time-series style features (currently used implicitly via other models).


What is AI vs what is simulated?
--------------------------------
- There is **no call to OpenAI/Anthropic or any external AI API**; everything runs locally in TypeScript.
- The system treats the following as "models":
  - `transaction-categorizer` (NLP-like classifier)
  - `spending-forecaster` (time-series forecaster)
  - `budget-allocator` (optimization model)
  - `goal-predictor` (probabilistic simulator)
  - `anomaly-detector` (outlier detector)
- Each one uses deterministic rules, statistics, and hand-crafted "trained" artifacts to **simulate** behavior of real ML without training infrastructure.


Uniqueness vs typical personal finance apps
-------------------------------------------

Similar to existing systems:
- Budgeting concepts:
  - Categories, allocations, remaining amounts, overspend detection.
  - Transaction history with search, filter, group-by-date.
  - Goal tracking with target, progress, and deadlines.
  - Reports page with charts of income, expenses, and category splits.
- UX patterns:
  - Sidebar navigation, dashboard cards, dialogs, toasts.
  - Auth flows (login/register), settings, notifications.

Unique / differentiating aspects in this codebase:
1. **Local AI service abstraction**
   - Instead of wiring directly to a cloud model, all "AI" lives behind `aiService`, making it easy to later swap in real models or a backend without changing UI pages.
   - Models are composable and share a common `TrainingTransaction` representation.

2. **Flux Pods concept**
   - Many budgeting apps use envelopes or categories; Flux Pods extend this with:
     - Explicit velocity (days to depletion) and health states.
     - Per-pod AI forecasts for days until budget exhaustion.
     - AI suggestions for **new** pods and how much to allocate, backed by spending history and learned budget shares.

3. **Goals with simulated Monte Carlo predictions**
   - Most consumer apps either show a static progress bar or simple linear projection.
   - Here, `goal-predictor` runs a seeded Monte Carlo-style simulation to capture variability and provides:
     - Confidence-weighted probability of success.
     - Confidence interval and risk factors.
     - This is all local and explainable in code, no external model required.

4. **Inline AI in everyday workflows**
   - Transaction flow:
     - Natural language Quick Entry + AI category suggestion + anomaly detection, all surfaced directly inside the main table.
   - Edit flow:
     - AI recategorize button within the edit modal.
   - Flux Pods:
     - AI suggestion panel when naming a new pod, with reasoning and one-click application.
   - Companion chat:
     - Tightly integrated with underlying stats (via `getDashboardInsights`), not just a generic Q&A.

5. **3D Financial Nexus visualization**
   - Use of `@react-three/fiber` and `@react-three/drei` to present a **3D graph** of the user’s financial components is uncommon in typical budgeting UIs.
   - Animated central core, orbit rings, data flow lines between nodes visually represent relationships (income → pods → goals → net worth, etc.).

6. **Synthetic training and explainable heuristics**
   - All "trained artifacts" are checked into the repo as TypeScript modules.
   - Feature extraction and scoring is transparent and auditable.
   - This is very different from black-box cloud models; good for demos, offline prototyping, and explainability.

7. **Gamification and narrative layer**
   - Achievements system is designed around behaviors that intersect with AI features (Flux Pod Master, Nexus Explorer, Budget Warrior), giving a clearer story around why the AI suggestions matter.


How to evolve to real models
----------------------------
- Swap simulated logic in each model file with calls to:
  - A backend service that wraps actual ML models (e.g., Python/Sklearn, PyTorch, or cloud AutoML) trained on real user data.
  - Or, call LLMs / embeddings APIs for categorization and explanation, while preserving the same `aiService` interface.
- Keep `aiService` as the single integration point, so pages remain largely unchanged when upgrading to real AI.


File index (for reference)
--------------------------
- AI service & models:
  - `src/lib/ai/ai-service.ts`
  - `src/lib/ai/training-data.ts`
  - `src/lib/ai/companion.ts`
  - `src/lib/ai/models/transaction-categorizer.ts`
  - `src/lib/ai/models/spending-forecaster.ts`
  - `src/lib/ai/models/budget-allocator.ts`
  - `src/lib/ai/models/goal-predictor.ts`
  - `src/lib/ai/models/anomaly-detector.ts`
  - `src/lib/ai/models/artifacts/*` (trained weights, priors, averages, etc.)

- Core pages:
  - `src/pages/index.tsx`        – Nexus Hub dashboard
  - `src/pages/Transactions.tsx` – Transaction Center + AI features
  - `src/pages/FluxPods.tsx`     – Flux Pods with forecasts and allocations
  - `src/pages/Goals.tsx`        – Goals & Orbits with predictions
  - `src/pages/Companion.tsx`    – AI Companion chat
  - `src/pages/Reports.tsx`      – Charts and exports
  - `src/pages/Achievements.tsx` – Gamification
  - `src/pages/Settings.tsx`     – Settings & data
  - `src/pages/Auth.tsx`         – Auth UI
  - `src/pages/NotFound.tsx`     – 404 route
